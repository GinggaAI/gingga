---
http_interactions:
- request:
    method: post
    uri: https://api.openai.com/v1/chat/completions
    body:
      encoding: UTF-8
      string: '{"model":"gpt-4o","temperature":0.4,"response_format":{"type":"json_object"},"messages":[{"role":"system","content":"You
        are CREAS Strategist (Noctua). Design a monthly social content plan balancing
        the 5 pillars:\nC Growth • R Retention • E Scalability • A Activation • S
        Satisfaction.\nKey rule: prioritize the month''s primary objective (awareness
        | engagement | sales | community) while always covering all 5 pillars. Include
        concrete remix/duet opportunities.\n\nMANDATORY BRIEF (ask \u0026 wait)\n1
        Brand name; 2 Sector/industry; 3 Audience profile (demographics, pains, digital
        behavior);\n4 Languages: publishing language(s); account primary language;
        bilingual split %;\n5 Target region \u0026 timezone; 6 Value proposition;
        7 Main offer/product; 8 Purpose/mission;\n9 Tone \u0026 style; 10 Priority
        platforms; 11 Monthly themes/campaigns;\n12 Primary objective (awareness |
        engagement | sales | community);\n13 Available resources (stock/podcast clips/editing/budget/AI
        avatars/Kling…);\n14 Posts per week (int); 15 Remix/duet references; 16 Restrictions/guardrails
        (legal, banned words, claims rules) + preferred CTAs.\nIf a critical item
        is missing, ask before generating.\n\nSTRATEGY RULES\n• CRITICAL: weekly_plan
        must contain exactly 4 weeks, each with exactly frequency_per_week ideas in
        the ideas array.\n• Generate exactly frequency_per_week × 4 weeks of content
        ideas (e.g., 3/week = 12 total, 4/week = 16 total).\n• Distribute weekly posting
        volume strategically across platforms/pillars.\n• Map clear goals \u0026 formats
        to each pillar.\n• Every idea must include a specific hook + story logic.\n•
        Balance: primary pillar = 40–50% of pieces; other four pillars = 50–60% total.\n•
        Include feasible remix/duet angles (topic + style).\n• Respect resources +
        languages.\n• Output JSON only, exactly matching the contract.\n\nOUTPUT CONTRACT
        (single JSON object; no prose)\nRoot:\n{\n  \"brand_name\":\"...\", \"brand_slug\":\"...\",
        \"strategy_name\":\"...\",\n  \"month\":\"YYYY-MM\", \"general_theme\":\"...\",\n  \"objective_of_the_month\":\"awareness
        | engagement | sales | community\",\n  \"frequency_per_week\":[frecuency_per_week],\n  \"platforms\":[\"Instagram\",\"TikTok\"],\n  \"tone_style\":\"...\",\n  \"content_language\":\"en-US\",
        \"account_language\":\"en-US\",\n  \"target_region\":\"...\", \"timezone\":\"...\",\n  \"subtitle_languages\":[],
        \"dub_languages\":[],\n  \"publish_windows_local\":{},   // optional, local
        HH:MM-HH:MM ranges\n  \"brand_guardrails\":{\"banned_words\":[],\"claims_rules\":\"\",\"tone_no_go\":[]},\n  \"post_types\":[\"Video\",\"Image\",\"Carousel\",\"Text\"],\n\n  \"content_distribution\":
        { \"C\": PILLAR_OBJ, \"R\": PILLAR_OBJ, \"E\": PILLAR_OBJ, \"A\": PILLAR_OBJ,
        \"S\": PILLAR_OBJ },\n\n  \"remix_duet_plan\": {\n    \"rationale\":\"Why
        remix/duet helps this month\",\n    \"opportunities\":[{\"id\":\"YYYYMM-\u003cbrand_slug\u003e-RMX-1\",\"title\":\"...\",\"style\":\"reaction
        | pip | caption-overlay\",\"recommended_template\":\"remix\",\"video_source\":\"external\",\"assets_hints\":{\"external_video_url\":\"\"},\"script_angle\":\"Insight
        + takeaway + CTA\",\"kpi_focus\":\"reach\",\"success_criteria\":\"≥X views/48h\"}]\n  },\n\n  \"weekly_plan\":[\n    {\"week\":1,\"publish_cadence\":frequency_per_week,\"ideas\":[WEEK_IDEA_OBJ,WEEK_IDEA_OBJ,WEEK_IDEA_OBJ]},\n    {\"week\":2,\"publish_cadence\":frequency_per_week,\"ideas\":[WEEK_IDEA_OBJ,WEEK_IDEA_OBJ,WEEK_IDEA_OBJ]},\n    {\"week\":3,\"publish_cadence\":frequency_per_week,\"ideas\":[WEEK_IDEA_OBJ,WEEK_IDEA_OBJ,WEEK_IDEA_OBJ]},\n    {\"week\":4,\"publish_cadence\":frequency_per_week,\"ideas\":[WEEK_IDEA_OBJ,WEEK_IDEA_OBJ,WEEK_IDEA_OBJ]}\n  ]\n  \n  CRITICAL:
        Each week MUST have exactly frequency_per_week items in the ideas array. \n  If
        frequency_per_week=3, each week needs exactly 3 items.\n  If frequency_per_week=4,
        each week needs exactly 4 items.\n  NO EXCEPTIONS. COUNT THE ITEMS BEFORE
        RESPONDING.\n}\n\nPILLAR_OBJ (use for each key C/R/E/A/S):\n{\n  \"goal\":\"...\",
        \"formats\":[\"...\",\"...\"],\n  \"ideas\":[IDEA_OBJ, IDEA_OBJ]\n}\n\nIDEA_OBJ
        (for content_distribution ideas):\n{\n  \"id\":\"YYYYMM-\u003cbrand_slug\u003e-\u003cPILLAR\u003e-w\u003cweek\u003e-i\u003cidx\u003e\",\n  \"status\":\"draft
        | in_production | ready_for_review | approved\",\n  \"title\":\"...\", \"hook\":\"...\",\n  \"description\":\"Highly
        detailed tactical brief (context, beats, key points, pillar objective, tone
        cues, concrete examples).\",\n  \"platform\":\"Instagram | TikTok | YouTube
        Shorts | LinkedIn\",\n  \"recommended_template\":\"solo_avatars | avatar_and_video
        | narration_over_7_images | remix | one_to_three_videos\",\n  \"video_source\":\"none
        | external | kling\",\n  \"visual_notes\":\"Shots, pacing, captions, overlays.\",\n  \"assets_hints\":{\"external_video_url\":\"\",\"external_video_notes\":\"e.g.,
        use 00:03–00:08 for Hook\",\"video_prompts\":[],\"broll_suggestions\":[]},\n  \"kpi_focus\":\"reach
        | saves | comments | CTR | DM\",\n  \"success_criteria\":\"e.g., ≥8% saves\",\n  \"beats_outline\":[\"Hook:
        ...\",\"Value: ...\",\"CTA: ...\"],\n  \"cta\":\"Specific CTA\",\n  \"pilar\":\"C|R|E|A|S\",\n  \"repurpose_to\":[],
        \"language_variants\":[]\n}\n\nWEEK_IDEA_OBJ (for weekly_plan.ideas):\n{\n  \"id\":\"YYYYMM-\u003cbrand_slug\u003e-w\u003cweek\u003e-i\u003cidx\u003e-\u003cPILLAR\u003e\",\n  \"status\":\"draft\",\n  \"title\":\"...\",
        \"hook\":\"...\",\n  \"description\":\"Production-ready brief (context, beats,
        examples, pillar objective, tone, language variants).\",\n  \"platform\":\"Instagram
        Reels\",\n  \"pilar\":\"C|R|E|A|S\",\n  \"recommended_template\":\"solo_avatars
        | avatar_and_video | narration_over_7_images | remix | one_to_three_videos\",\n  \"video_source\":\"none
        | external | kling\",\n  \"visual_notes\":\"...\",\n  \"assets_hints\":{\"external_video_url\":\"\",\"video_prompts\":[],\"broll_suggestions\":[]},\n  \"kpi_focus\":\"reach\",
        \"success_criteria\":\"≥X metric\",\n  \"beats_outline\":[\"Hook\",\"Value\",\"CTA\"],\n  \"cta\":\"...\",
        \"repurpose_to\":[], \"language_variants\":[]\n}\n\nID RULES\nbrand_slug:
        lowercase, hyphenated from brand_name (no spaces/accents). week starts at
        1; idx starts at 1. IDs must be unique.\nDistribution IDs: YYYYMM-\u003cbrand_slug\u003e-\u003cPILLAR\u003e-w\u003cweek\u003e-i\u003cidx\u003e\nWeekly
        IDs: YYYYMM-\u003cbrand_slug\u003e-w\u003cweek\u003e-i\u003cidx\u003e-\u003cPILLAR\u003e\n\nALLOWED
        VALUES\nobjective_of_the_month: awareness | engagement | sales | community\nrecommended_template:
        solo_avatars | avatar_and_video | narration_over_7_images | remix | one_to_three_videos\nvideo_source:
        none | external | kling\nkpi_focus: reach | saves | comments | CTR | DM\nstatus:
        draft | in_production | ready_for_review | approved\n\nFINAL VALIDATION CHECKLIST
        (MANDATORY - auto-check before output):\n✓ 1. Brief complete; else ask\n✓
        2. CRITICAL MATH CHECK: weekly_plan has exactly 4 weeks\n✓ 3. CRITICAL COUNT
        CHECK: Each week has EXACTLY frequency_per_week ideas (count them!)\n   -
        Week 1 ideas array length = frequency_per_week ✓\n   - Week 2 ideas array
        length = frequency_per_week ✓  \n   - Week 3 ideas array length = frequency_per_week
        ✓\n   - Week 4 ideas array length = frequency_per_week ✓\n✓ 4. CRITICAL TOTAL
        CHECK: Total ideas = frequency_per_week × 4\n✓ 5. Primary pillar 40–50%; others
        50–60% total\n✓ 6. Language guidance aligns with content_language/splits\n✓
        7. Each idea has recommended_template + correct video_source\n✓ 8. All IDs
        valid/unique; month = YYYY-MM\n✓ 9. Respect brand_guardrails\n✓ 10. Return
        single JSON object; no prose/markdown\n\nSTOP AND COUNT THE IDEAS IN EACH
        WEEK BEFORE RESPONDING!\n"},{"role":"user","content":"# MANDATORY BRIEF\n{\"brand_info\":\"Test
        brand\"}\n"}]}'
    headers:
      Content-Type:
      - application/json
      Authorization:
      - Bearer <OPENAI_API_KEY>
      Accept-Encoding:
      - gzip;q=1.0,deflate;q=0.6,identity;q=0.3
      Accept:
      - "*/*"
      User-Agent:
      - Ruby
  response:
    status:
      code: 200
      message: OK
    headers:
      Date:
      - Wed, 27 Aug 2025 10:27:46 GMT
      Content-Type:
      - application/json
      Transfer-Encoding:
      - chunked
      Connection:
      - keep-alive
      Access-Control-Expose-Headers:
      - X-Request-ID
      Openai-Organization:
      - user-q9y5zog3dre23sibb14mkovp
      Openai-Processing-Ms:
      - '1319'
      Openai-Project:
      - proj_UubrcgXHT3kZCCO0wLYXoBxg
      Openai-Version:
      - '2020-10-01'
      X-Envoy-Upstream-Service-Time:
      - '1325'
      X-Ratelimit-Limit-Requests:
      - '500'
      X-Ratelimit-Limit-Tokens:
      - '30000'
      X-Ratelimit-Remaining-Requests:
      - '499'
      X-Ratelimit-Remaining-Tokens:
      - '28243'
      X-Ratelimit-Reset-Requests:
      - 120ms
      X-Ratelimit-Reset-Tokens:
      - 3.514s
      X-Request-Id:
      - req_e931104a95ce4b49abb1038b5e6cea3a
      Cf-Cache-Status:
      - DYNAMIC
      Set-Cookie:
      - __cf_bm=XHQ_3hjpCCSW0649mabAOz2CYmN4VF9Qg_S3OE4QOto-1756290466-1.0.1.1-e0dftb_nWg1Fhz3MOjTf1IknGLKGeLrXrJItKZVXZskHRJnrYqY2Hx0vTRiBfvJTg8nd3EygBdIikw1cmfmUdH.hduB8jLqqzhMYv1IBe6E;
        path=/; expires=Wed, 27-Aug-25 10:57:46 GMT; domain=.api.openai.com; HttpOnly;
        Secure; SameSite=None
      - _cfuvid=brW4VkzTu6oFGB0XXVi4r3WhZ8zvxP4li.LfS_nGVb0-1756290466669-0.0.1.1-604800000;
        path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None
      Strict-Transport-Security:
      - max-age=31536000; includeSubDomains; preload
      X-Content-Type-Options:
      - nosniff
      Server:
      - cloudflare
      Cf-Ray:
      - 975ae0cd5903bee9-LHR
      Alt-Svc:
      - h3=":443"; ma=86400
    body:
      encoding: ASCII-8BIT
      string: |
        {
          "id": "chatcmpl-C97fVg2ieuUf8vGTOA0gX54u6rxzl",
          "object": "chat.completion",
          "created": 1756290465,
          "model": "gpt-4o-2024-08-06",
          "choices": [
            {
              "index": 0,
              "message": {
                "role": "assistant",
                "content": "{\"error\":\"Incomplete brief. Please provide the full mandatory brief details including brand name, sector/industry, audience profile, languages, target region & timezone, value proposition, main offer/product, purpose/mission, tone & style, priority platforms, monthly themes/campaigns, primary objective, available resources, posts per week, remix/duet references, restrictions/guardrails, and preferred CTAs.\"}",
                "refusal": null,
                "annotations": []
              },
              "logprobs": null,
              "finish_reason": "stop"
            }
          ],
          "usage": {
            "prompt_tokens": 1877,
            "completion_tokens": 82,
            "total_tokens": 1959,
            "prompt_tokens_details": {
              "cached_tokens": 0,
              "audio_tokens": 0
            },
            "completion_tokens_details": {
              "reasoning_tokens": 0,
              "audio_tokens": 0,
              "accepted_prediction_tokens": 0,
              "rejected_prediction_tokens": 0
            }
          },
          "service_tier": "default",
          "system_fingerprint": "fp_46bff0e0c8"
        }
  recorded_at: Wed, 27 Aug 2025 10:27:46 GMT
recorded_with: VCR 6.3.1
