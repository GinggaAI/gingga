%main.flex-1.overflow-y-auto{data: { controller: "planning", planning_current_month_value: @presenter.safe_month_for_js, planning_current_plan_value: @presenter.current_plan_json }}
  .p-8
    .max-w-6xl.mx-auto
      .mb-8
        %h1.text-3xl.font-bold.text-gray-900.mb-2= t('planning.title')
        %p.text-gray-600= t('planning.subtitle')

      .bg-card.text-card-foreground.border-0.shadow-lg.rounded-2xl.mb-6
        .flex.items-center.justify-between.p-6
          .flex.items-center.gap-4
            %button.px-3.py-1.text-gray-600.hover:text-gray-800
              %span â†
            %h2.text-2xl.font-bold.text-gray-900= @presenter.display_month
            %button.px-3.py-1.text-gray-600.hover:text-gray-800
              %span â†’

          .flex.items-center.gap-3
            %button#toggle-overview.inline-flex.items-center.justify-center.gap-2.whitespace-nowrap.text-sm.font-medium.ring-offset-background.transition-colors.focus-visible:outline-none.focus-visible:ring-2.focus-visible:ring-ring.focus-visible:ring-offset-2.disabled:pointer-events-none.disabled:opacity-50.border.border-input.bg-background.hover:bg-accent.hover:text-accent-foreground.h-9.px-3.rounded-xl= t('planning.see_general_strategy')
            %button#voxa-refine.inline-flex.items-center.justify-center.gap-2.whitespace-nowrap.ring-offset-background.transition-colors.focus-visible:outline-none.focus-visible:ring-2.focus-visible:ring-ring.focus-visible:ring-offset-2.disabled:pointer-events-none.disabled:opacity-50.bg-primary.h-10.px-4.bg-gradient-to-r.text-white.font-medium.py-2.rounded-xl{class: "[&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0 hover:bg-primary/90 from-[#A37FFF] to-[#3AC8FF] hover:from-[#3AC8FF] hover:to-[#A37FFF]", style: "display: none;"}
              %span#voxa-button-text= t('planning.refine_with_voxa')
            %button#toggle-form.inline-flex.items-center.justify-center.gap-2.whitespace-nowrap.ring-offset-background.transition-colors.focus-visible:outline-none.focus-visible:ring-2.focus-visible:ring-ring.focus-visible:ring-offset-2.disabled:pointer-events-none.disabled:opacity-50.bg-primary.h-10.px-4.bg-gradient-to-r.text-black.font-medium.py-2.rounded-xl{class: "[&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0 hover:bg-primary/90 from-[#FFC940] to-[#FF6848] hover:from-[#FF6848] hover:to-[#A37FFF]"}
              %span#button-text= t('planning.add_content')

      #strategy-form.bg-card.text-card-foreground.border-0.shadow-lg.rounded-2xl.mb-6{style: "display: none;"}
        .p-6
        .flex.items-center.justify-between.mb-4
          %h3.text-lg.font-semibold= t('planning.strategy_form.title')
          #form-status.text-sm.text-gray-500{style: "display: none;"}

        = form_with url: creas_strategist_index_path, method: :post, local: false,
            id: "strategy-creation-form", class: "strategy-form" do |form|
          = form.hidden_field :month, value: @presenter.safe_month_for_js

          .grid.grid-cols-1.md:grid-cols-2.gap-4.mb-4
            .col-span-1.md:col-span-2
              = form.label "strategy_form[objective_of_the_month]", t('planning.strategy_form.objective_label'),
                  class: "block text-sm font-medium mb-1 text-gray-700"
              = form.text_area "strategy_form[objective_of_the_month]",
                  placeholder: t('planning.strategy_form.objective_placeholder'),
                  rows: 3, class: "w-full p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",
                  required: true

            .col-span-1
              = form.label "strategy_form[monthly_themes]", t('planning.strategy_form.monthly_themes_label'),
                  class: "block text-sm font-medium mb-1 text-gray-700"
              = form.text_field "strategy_form[monthly_themes]",
                  placeholder: t('planning.strategy_form.monthly_themes_placeholder'),
                  class: "w-full p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
              %p.text-xs.text-gray-500.mt-1= t('planning.strategy_form.monthly_themes_help')

            .col-span-1
              = form.label "strategy_form[frequency_per_week]", t('planning.strategy_form.frequency_label'),
                  class: "block text-sm font-medium mb-1 text-gray-700"
              = form.number_field "strategy_form[frequency_per_week]",
                  placeholder: t('planning.strategy_form.frequency_placeholder'), min: 1, max: 7, value: 3,
                  class: "w-full p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",
                  required: true

          .mb-4
            %h3.block.text-sm.font-medium.mb-3.text-gray-700= t('planning.strategy_form.resources_title')
            %p.text-xs.text-gray-500.mb-3= t('planning.strategy_form.resources_subtitle')

            .grid.grid-cols-1.md:grid-cols-2.gap-4.mb-3
              .col-span-1
                %label.block.text-sm.font-medium.mb-1.text-gray-600= t('planning.strategy_form.budget_label')
                %select#budget-select.w-full.p-2.border.border-gray-300.rounded-md.focus:ring-2.focus:ring-blue-500.focus:border-blue-500
                  %option{value: ""}= t('planning.strategy_form.budget_options.none')
                  %option{value: "500"}= t('planning.strategy_form.budget_options.low')
                  %option{value: "1000"}= t('planning.strategy_form.budget_options.medium')
                  %option{value: "2500"}= t('planning.strategy_form.budget_options.high')
                  %option{value: "5000"}= t('planning.strategy_form.budget_options.premium')

              .col-span-1
                %label.block.text-sm.font-medium.mb-1.text-gray-600= t('planning.strategy_form.team_size_label')
                %select#team-size-select.w-full.p-2.border.border-gray-300.rounded-md.focus:ring-2.focus:ring-blue-500.focus:border-blue-500
                  %option{value: ""}= t('planning.strategy_form.team_size_options.none')
                  %option{value: "1"}= t('planning.strategy_form.team_size_options.solo')
                  %option{value: "2"}= t('planning.strategy_form.team_size_options.small')
                  %option{value: "3"}= t('planning.strategy_form.team_size_options.medium')
                  %option{value: "5"}= t('planning.strategy_form.team_size_options.large')

            .grid.grid-cols-1.md:grid-cols-2.gap-4.mb-3
              .col-span-1
                %label.block.text-sm.font-medium.mb-1.text-gray-600= t('planning.strategy_form.design_tools_label')
                %select#tools-select.w-full.p-2.border.border-gray-300.rounded-md.focus:ring-2.focus:ring-blue-500.focus:border-blue-500{multiple: true, size: "3"}
                  %option{value: "Canva"} Canva
                  %option{value: "Photoshop"} Adobe Photoshop
                  %option{value: "Figma"} Figma
                  %option{value: "Sketch"} Sketch
                  %option{value: "After Effects"} After Effects
                  %option{value: "Premiere Pro"} Premiere Pro
                  %option{value: "Final Cut"} Final Cut Pro
                %p.text-xs.text-gray-500.mt-1= t('planning.strategy_form.design_tools_help')

              .col-span-1
                %label.block.text-sm.font-medium.mb-1.text-gray-600= t('planning.strategy_form.content_resources_label')
                .space-y-2
                  %label.flex.items-center
                    %input#ai-avatars-checkbox.mr-2{type: "checkbox"}
                    %span.text-sm= t('planning.strategy_form.use_ai_avatars')
                  %label.flex.items-center
                    %input#stock-photos-checkbox.mr-2{type: "checkbox"}
                    %span.text-sm= t('planning.strategy_form.use_stock_photos')
                  %label.flex.items-center
                    %input#custom-graphics-checkbox.mr-2{type: "checkbox"}
                    %span.text-sm= t('planning.strategy_form.create_custom_graphics')

            = form.hidden_field "strategy_form[resources_override]", id: "resources-override-json"

          .flex.justify-between.items-center
            %button#cancel-form.inline-flex.items-center.justify-center.gap-2.whitespace-nowrap.text-sm.font-medium.ring-offset-background.transition-colors.focus-visible:outline-none.focus-visible:ring-2.focus-visible:ring-ring.focus-visible:ring-offset-2.disabled:pointer-events-none.disabled:opacity-50.border.border-input.bg-background.hover:bg-accent.hover:text-accent-foreground.h-9.px-3.rounded-xl{type: "button"}
              = t('buttons.cancel')
            %button#submit-strategy.inline-flex.items-center.justify-center.gap-2.whitespace-nowrap.ring-offset-background.transition-colors.focus-visible:outline-none.focus-visible:ring-2.focus-visible:ring-ring.focus-visible:ring-offset-2.disabled:pointer-events-none.disabled:opacity-50.bg-primary.h-10.px-4.bg-gradient-to-r.text-black.font-medium.py-2.rounded-xl.disabled:bg-gray-400{class: "[&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0 hover:bg-primary/90 from-[#FFC940] to-[#FF6848] hover:from-[#FF6848] hover:to-[#A37FFF]", type: "submit"}
              %span.submit-text= t('planning.strategy_form.generate_strategy')
              %span.loading-spinner{style: "display: none;"}
                %svg.animate-spin.w-4.h-4.inline.mr-2{fill: "none", viewBox: "0 0 24 24"}
                  %circle.opacity-25{cx: "12", cy: "12", r: "10", stroke: "currentColor", "stroke-width": "4"}
                  %path.opacity-75{fill: "currentColor", d: "m4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"}
                = t('planning.strategy_form.generating')

      #strategy-result.bg-card.text-card-foreground.border-0.shadow-lg.rounded-2xl.p-6.mb-6{style: "display: none;"}
        .flex.items-start.justify-between.mb-6
          .flex.items-center.gap-2
            %svg.w-5.h-5.text-green-600{fill: "currentColor", viewBox: "0 0 20 20"}
              %path{"fill-rule": "evenodd", d: "M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z", "clip-rule": "evenodd"}
            %h2.text-xl.font-bold.text-green-700= t('planning.strategy_result.title')
          %button.text-gray-400.hover:text-gray-600.text-xl.font-bold{data: { action: "click->planning#hideStrategyOverview" }} &times;

        / Separator
        .w-full.h-px.bg-gray-200.mb-6

        / Metrics as KPIs
        .grid.grid-cols-2.md:grid-cols-4.gap-6.text-center.mb-6
          .space-y-1
            %p.text-sm.text-gray-500= t('planning.strategy_result.strategy_name_label')
            %p#strategy-name.text-lg.font-bold.text-gray-800 -
            %p.text-sm.text-gray-600= t('planning.strategy_result.content_strategy_label')
          .space-y-1
            %p.text-sm.text-gray-500= t('planning.strategy_result.posts_per_week_label')
            %p#strategy-frequency.text-2xl.font-extrabold.text-gray-900 -
          .space-y-1
            %p.text-sm.text-gray-500= t('planning.strategy_result.total_posts_label')
            %p#strategy-total.text-2xl.font-extrabold.text-gray-900 -
            %p.text-sm.text-gray-600= t('planning.strategy_result.posts_unit')
          .space-y-1
            %p.text-sm.text-gray-500= t('planning.strategy_result.monthly_objective_label')
            %p#strategy-objective.text-lg.font-bold.text-indigo-700 -

        / Separator
        .w-full.h-px.bg-gray-200.mb-6

        / Content Themes
        .space-y-3
          %h3.text-lg.font-bold.text-gray-800= t('planning.strategy_result.content_themes_title')
          #strategy-themes.flex.flex-wrap.gap-2 -

      #error-message.bg-card.text-card-foreground.border-0.shadow-lg.rounded-2xl.p-4.mb-6{style: "display: none;"}
        .flex.items-center.gap-2.text-red-800
          %svg.w-5.h-5{fill: "currentColor", viewBox: "0 0 20 20"}
            %path{"fill-rule": "evenodd", d: "M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z", "clip-rule": "evenodd"}
          %span#error-text= t('planning.messages.error_generating')

      .space-y-6
        - (1..4).each do |week_number|
          .bg-card.text-card-foreground.border-0.shadow-lg.rounded-2xl
            .flex.items-center.justify-between.p-4.border-b
              %h3.font-semibold.text-gray-900= "#{t('planning.weeks.week')} #{week_number}"
              .flex.items-center.gap-2
                %span.text-sm= t('planning.weeks.goal_label')
                %select.p-1.border.rounded.text-sm
                  %option= t('planning.weeks.goals.awareness')
                  %option= t('planning.weeks.goals.engagement')
                  %option= t('planning.weeks.goals.conversion')

            .p-4
              .grid.grid-cols-7.gap-4
                - [t('planning.weeks.days.mon'), t('planning.weeks.days.tue'), t('planning.weeks.days.wed'), t('planning.weeks.days.thu'), t('planning.weeks.days.fri'), t('planning.weeks.days.sat'), t('planning.weeks.days.sun')].each_with_index do |day, index|
                  .text-center
                    %h4.text-sm.font-medium.mb-2= day
                    .bg-gray-50.rounded.p-3.week-content-slot{style: "min-height: 120px;"}
                      %button.w-full.h-8.border-2.border-dashed.border-gray-300.rounded.text-gray-400.hover:border-gray-400.hover:text-gray-600
                        +

          .week-details.bg-gray-50.p-4.rounded.mt-4{style: "display: none;", id: "week-details-#{week_number - 1}"}
            .text-lg.font-semibold.mb-3.text-gray-700 ðŸ“‹ #{t('planning.weeks.week_details', number: week_number)}
            .content-details-grid.grid.grid-cols-1.gap-3

/ JavaScript moved to app/javascript/controllers/planning_controller.js
